\chapter{Smithův normální tvar}
\setcounter{page}{1}
\pagenumbering{arabic}

V této kapitole se budeme zbývat definicí Smithova normálního tvaru (budeme značit \snf) celočíselných matic $\Zmat$, dokážeme jeho existenci pro libovolnou $A \in \Zmat$ a konečně uvedeme souvislost mezi \snf  a konečně generovanými komutativními grupami.

\begin{defi}Řekneme že matice A $ \in \Zmat $ je ve Smithově normálním tvaru jestliže
\begin{center}
$ A =
    \begin{pmatrix}
        q_1     & 0      & \cdots & \cdots & \cdots & \cdots & 0      \\
        0       & q_2    & \ddots &        &        &        & \vdots \\
        \vdots  & \ddots & \ddots & \ddots &        &        & \vdots \\
        \vdots  &        & \ddots & q_k    & \ddots &        & \vdots \\
        \vdots  &        &        & \ddots & 0      & \ddots & \vdots \\
        \vdots  &        &        &        & \ddots & \ddots & 0      \\
        0       & \cdots & \cdots & \cdots & \cdots & 0      & 0      \\
    \end{pmatrix}
$
\end{center}
a platí $q_i | q_{i+1}$ kde $i \in \{1, \dots, k-1\}$. Čísla $q_i$ pak nazýváme
\textit{invariantními faktory}.
\end{defi}


\begin{vet}[O Smithově normálním tvaru]
    Pro libovolnou celočíselnou matici $ B \in \Zmat $ existují invertibilní
    matice $ P,Q \in \Zmat $ a matice $ A $ ve Smithově normálním tvaru takové,
    že platí
    \begin{center}
        $ B = P \cdot A \cdot Q $
    \end{center}
    Smithův normální tvar je jednoznačný až na znaménka invariantních faktorů.
\end{vet}


Než se pustíme do samotného důkazu této věty, je dobré si uvědomit, jak vlastně
vypadají invertibilní celočíselné matice. To popisuje následující lemma.


\begin{lem}
    Buď $A \in \Zmat$. Pak je A invertiblní, právě tehdy když je čtvercová a
    $\textnormal{det}(A) = \pm1$.
\end{lem}
\begin{proof}
    Buď $A \in \Zmat$ invertibilní. Existuje tedy matice $A^{-1} \in \Zmat$
    taková, že $AA^{-1} = E$. Pak je ovšem $A^{-1}$ inverzí pro $A$ také nad
    $\mathbb{Q}$. Proto $A$ musí být čtvercová, neboť každá invertiblní matice
    nad $\mathbb{Q}$ je čtvercová a má nenulový determinant. Navíc platí
    \begin{center}
        $det(A) \cdot \det(A^{-1}) = det(AA^{-1}) = det(E) = 1$
    \end{center}
    a protože determinant celočíselné matice je z definice determinantu
    také celočíselný, musí platit $det(A) = det(A^{-1}) = \pm1$ neboť v okruhu
    $\mathbb{Z}$ máme pouze dvě jednotky a to právě $\pm1$.

    Buď naopak  $A \in \Zmat$ čtvercová s determinantem $\pm1$. Pak inverzní
    matici $A^{-1}$ můžeme spočítat z algebraických doplňků jako
    \begin{center}
        $A^{-1} = \frac{1}{det(A)} \cdot A_{adj} = \pm A_{adj}$
    \end{center}
    nicméně prvky matice $A_{adj}$ - algebraické doplňky - se vypočítají
    ze subdeterminantů (minorů) matice A a musí být proto celočíselné. Matice
    $A^{-1}$ je tedy celočíselná.
\end{proof}

Z tohoto lemmatu tedy plyne, že pokud chceme celočíselnou matici B převést do
\snf pomocí invertibilních matic, musíme tak činit pouze prostřednictvím
matic majících determinant $\pm1$. Nyní tedy můžeme přikročit k důkazu samotné
věty o \snf.

\begin{proof}[Důkaz. (Věty o Smithově normálním tvaru)]
Nejprve dokážeme existenci \snf. Pro tento účel budeme potřebovat Euklidův
algoritmus. Ten funguje následujícím způsobem.

Pro libovolná $ a, b \in \mathbb{Z}$ taková, že $ |a| > |b| $ vydělíme číslo
$ a $ číslem $ b $ se zbytkem. Tedy $ a = qb + c $. Pak ovšem platí, že
$ gcd(a, b) = gcd(b, c) $ neboť

\begin{center}
$ gcd(a, b) = d \Rightarrow d \vert (a - qb) \Rightarrow d \vert c \Rightarrow d \vert gcd(b, c)$
\end{center}
a naopak
\begin{center}
$ gcd(b, c) = e \Rightarrow e \vert (qb + c) \Rightarrow e \vert a \Rightarrow e \vert gcd(a, b)$.
\end{center}
Takto můžeme postupovat rekurzivně a po konečném počtu kroků bude $ c = 0 $ a
$ b $ příslušné danému kroku bude právě hledaný největší společný dělitel.
Poznamenejme, že užití Euklidova algoritmu je z výpočetního hlediska výhodně, neboť
má logaritmickou složitost.

Dále protože výsledné transformační matice $ P, Q $ musí být invertibilní nad $\mathbb{Z}$,
plyne z předchozího lemmatu, že jejich determinant musí být roven $ \pm 1 $.
Evidentně tedy nemůžeme násobit řádek či sloupec matice jiným číslem než  $ \pm 1 $.
Můžeme však prohodit libovolné dva řádky, protože to lze realizovat pomocí
transformační matice,

\begin{center}
$
    \begin{pmatrix}
        1       &        &        &        &        &        &        \\
                & \ddots &        &        &        &        &        \\
                &        & 0      &        & 1      &        &        \\
                &        &        & \ddots &        &        &        \\
                &        & 1      &        & 0      &        &        \\
                &        &        &        &        & \ddots &        \\
                &        &        &        &        &        & 0      \\
    \end{pmatrix}
$
\end{center}
která má evidentně determinant roven $ -1 $. Analogicky můžeme prohazovat
prohazovat libovolné dva sloupce. A konečně pomocí transformační matice
\begin{center}
$
    \begin{pmatrix}
        1       &        &        &        &        &        &        \\
                & \ddots &        &        &        &        &        \\
                &        & 1      &        &        &        &        \\
                &        &        & \ddots &        &        &        \\
                &        & m      &        & 1      &        &        \\
                &        &        &        &        & \ddots &        \\
                &        &        &        &        &        & 1      \\
    \end{pmatrix}
$
\end{center}
můžeme k libovolnému řádku přičíst $ m $-násobek jiného řádku.

Nyní budeme postupovat následujícím způsobem. Na pozici $ (1, 1) $ přesuneme libovolný
nenulový prvek matice $ B $ (Pokud $ B = 0 $, pak je již ve \snf a žádné operace
provádět nemusíme). Pak postupně pro každý prvek pod a napravo od prvku $ b_1^1 $
aplikujeme Euklidův algoritmus (konkrétně jeho implementaci pomocí řádkových a
sloupcových operací, která potřebuje pouze operace násobení řádku/sloupce číslem $ -1 $,
přičítání násobku řádku/sloupce k jinému a prohazování dvou řádků/sloupců),
čímž na pozici $ (1, 1) $ vyrobíme největší společný prvků
v prvním sloupci a řádku. Tyto prvky můžeme tedy snadno vyeliminovat, čímž získáme
matici ve tvaru

\begin{center}
$ B =
    \begin{pmatrix}
        b_1^1   & 0      & \hdots & 0       \\
        0       & \ast   & \hdots & \ast    \\
        \vdots  & \vdots &        & \vdots   \\
        0       & \ast   & \hdots & \ast    \\
    \end{pmatrix}
$.
\end{center}


Pokud nyní existuje nějaký prvek $ b_j^i $, který ještě není dělitelný $ b_1^1 $, můžeme
přičíst $j$-tý sloupec k prvnímu sloupci a opět vyrobit na pozici $ (1, 1) $ prvek $ {b'}_{1}^{1} $
takový, že $ {b'}_{1}^{1} \vert b_1^1 $ a zároveň $ {b'}_{1}^{1} \vert b_j^i $,
který jej již dělit bude. Poznamenejme, že tento prvek bude nutně menší než původní
$ b_1^1 $, díky čemuž náš algoritmus skončí po konečném počtu kroků.

Celkem máme algoritmus, který převede matici $B$ do výše uvedeného tvaru a navíc
$ {b}_{1}^{1} \vert b_j^i $. Označme takto vzniklou matici $ C $ a nechť $ q_k = c_1^1 $.
Nyní můžeme postupovat indukcí a aplikovat tento algoritmus
na submatici, která vznikne vynecháním prvního sloupce a řádku matice $C$.
Neboť $ q_k $ dělil všechny prvky matice $C$, bude dělit i prvek v levém
horním rohu submatice (označme jej $ q_{k+1} $) po aplikaci výše uvedeného algoritmu.
Dostáváme, že $ q_k \vert q_{k+1}$, což jsme měli dokázat.



\end{proof}
\section{Podkapitola}

\lipsum[98-105]

\subsection{Odstavec}

\lipsum[140-145]
\shorthandon{-}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
